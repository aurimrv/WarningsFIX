<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<STYLE>
                <!-- 
                    .lineNum { width:40px; background:silver; text-align:right; padding-right:3px; color:maroon }
                    .reserved_word { color:blue; font:bold }
                    .comment { color:gray }
                    .literal { color:maroon }
                    TH.standard { font:bold; background:gray }
                    TABLE.standard { background:silver }
                    TR.standard { background:white }
             --> 
            </STYLE>
<TITLE>Hammurapi 3.18.4 []</TITLE>
</HEAD>
<BODY>
<H1>EvictionTimer.java</H1>
<BR>     
            Package: org.apache.commons.pool.impl<P></P>
<P></P>
<B style="color:blue">Results</B>
<table cellspacing="0" cellpadding="5">
<tr>
<th align="left">Date</th><td align="right">2016/06/28</td>
</tr>
<tr>
<th align="left">Codebase</th><td align="right">308</td>
</tr>
<tr>
<th align="left">Reviews</th><td align="right">515</td>
</tr>
<tr title="Defects per million opportunities">
<td align="left"><B>DPMO</B></td><td align="right">485 (not accurate because of warnings)</td>
</tr>
<tr title="Sigma">
<td align="left"><B>Sigma</B></td><td align="right">4,799 (not accurate because of warnings)</td>
</tr>
</table>
<P></P>
<B style="color:blue">Metrics</B>
<table border="0" cellspacing="1" cellpadding="3" class="standard">
<tr class="standard">
<th class="standard">Name</th><th class="standard">Number</th><th class="standard">Min</th><th class="standard">Avg</th><th class="standard">Max</th><th class="standard">Total</th>
</tr>
<tr class="standard">
<td>Class complexity</td><td align="right">1</td><td align="right">5.00</td><td align="right">5.00</td><td align="right">5.00</td><td align="right">5.00</td>
</tr>
<tr class="standard">
<td>Code length</td><td align="right">3</td><td align="right">0.00</td><td align="right">3.33</td><td align="right">5.00</td><td align="right">10.00</td>
</tr>
<tr class="standard">
<td>File length</td><td align="right">1</td><td align="right">75.00</td><td align="right">75.00</td><td align="right">75.00</td><td align="right">75.00</td>
</tr>
<tr class="standard">
<td>Operation complexity</td><td align="right">3</td><td align="right">1.00</td><td align="right">1.66</td><td align="right">2.00</td><td align="right">5.00</td>
</tr>
<tr class="standard">
<td>Work order</td><td align="right">1</td><td align="right">57.58</td><td align="right">57.58</td><td align="right">57.58</td><td align="right">57.58</td>
</tr>
</table>
<P></P>
<B style="color:blue">Violations</B>
<table border="0" cellspacing="1" cellpadding="3" class="standard">
<tr class="standard">
<th class="standard">#</th><th class="standard">Line</th><th class="standard">Column</th><th class="standard">Name</th><th class="standard">Severity</th><th class="standard">Description</th>
</tr>
<tr class="standard">
<td align="right">1</td><td align="right"><a href="#line_18">18</a></td><td align="right">1</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-023.html">ER-023</a></td><td align="right">3</td><td>Packages should begin with []</td>
</tr>
<tr class="standard">
<td align="right">2</td><td align="right"><a href="#line_54">54</a></td><td align="right">80</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-036.html">ER-036</a></td><td align="right">3</td><td>Line is too long</td>
</tr>
<tr class="standard">
<td align="right">3</td><td align="right"><a href="#line_38">38</a></td><td align="right">5</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-005.html">ER-005</a></td><td align="right">3</td><td>Classes, interfaces, methods, and variables should be named according to Sun's naming conventions.</td>
</tr>
<tr class="standard">
<td align="right">4</td><td align="right"><a href="#line_39">39</a></td><td align="right">5</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-005.html">ER-005</a></td><td align="right">3</td><td>Classes, interfaces, methods, and variables should be named according to Sun's naming conventions.</td>
</tr>
<tr class="standard">
<td align="right">5</td><td align="right"><a href="#line_41">41</a></td><td align="right">5</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-109.html">ER-109</a></td><td align="right">3</td><td>It is good practice to call in any case super() in a constructor. (see also: UnnecessaryConstructorRule )</td>
</tr>
<tr class="standard">
<td align="right">6</td><td align="right"><a href="#line_54">54</a></td><td align="right">5</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-008.html">ER-008</a></td><td align="right">2</td><td>Synchronize at the block level rather than the method level</td>
</tr>
<tr class="standard">
<td align="right">7</td><td align="right"><a href="#line_66">66</a></td><td align="right">5</td><td NOWRAP="yes"><a href="../../../../../../inspectors/inspector_ER-008.html">ER-008</a></td><td align="right">2</td><td>Synchronize at the block level rather than the method level</td>
</tr>
</table>
<P></P>
<B style="color:blue">Warnings</B>
<table border="0" cellspacing="1" cellpadding="3" class="standard">
<tr class="standard">
<th class="standard">#</th><th class="standard">Line</th><th class="standard">Column</th><th class="standard">Message</th>
</tr>
<tr class="standard">
<td align="right">1</td><td align="right"><a href="#line_37">37</a></td><td align="right">7</td><td>java.lang.ClassNotFoundException: Class not found: org.apache.log4j.Logger</td>
</tr>
<tr class="standard">
<td align="right">2</td><td align="right"><a href="#line_"></a></td><td align="right"></td><td>Inspector ER-086 disabled itself with message 'javax.servlet.Servlet'</td>
</tr>
</table>
<P></P>
<DL>
<DT>
<B style="color:blue">JavaDoc</B>
</DT>
<DD>
<a href="../../../../../../../javadoc/org/apache/commons/pool/impl/EvictionTimer.html">EvictionTimer</a>
</DD>
</DL>
<HR>
<PRE>
<a name="line_1" class="lineNum">1</a><span class="comment">/*<BR/><A class="lineNum" name="line_2">2</A> * Licensed to the Apache Software Foundation (ASF) under one or more<BR/><A class="lineNum" name="line_3">3</A> * contributor license agreements.  See the NOTICE file distributed with<BR/><A class="lineNum" name="line_4">4</A> * this work for additional information regarding copyright ownership.<BR/><A class="lineNum" name="line_5">5</A> * The ASF licenses this file to You under the Apache License, Version 2.0<BR/><A class="lineNum" name="line_6">6</A> * (the "License"); you may not use this file except in compliance with<BR/><A class="lineNum" name="line_7">7</A> * the License.  You may obtain a copy of the License at<BR/><A class="lineNum" name="line_8">8</A> *<BR/><A class="lineNum" name="line_9">9</A> *      http://www.apache.org/licenses/LICENSE-2.0<BR/><A class="lineNum" name="line_10">10</A> *<BR/><A class="lineNum" name="line_11">11</A> * Unless required by applicable law or agreed to in writing, software<BR/><A class="lineNum" name="line_12">12</A> * distributed under the License is distributed on an "AS IS" BASIS,<BR/><A class="lineNum" name="line_13">13</A> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<BR/><A class="lineNum" name="line_14">14</A> * See the License for the specific language governing permissions and<BR/><A class="lineNum" name="line_15">15</A> * limitations under the License.<BR/><A class="lineNum" name="line_16">16</A> */</span><BR/><A class="lineNum" name="line_17">17</A><BR/><A class="lineNum" name="line_18">18</A><span class="reserved_word">package</span> org.apache.commons.pool.impl;<BR/><A class="lineNum" name="line_19">19</A><BR/><A class="lineNum" name="line_20">20</A><span class="reserved_word">import</span> java.util.Timer;<BR/><A class="lineNum" name="line_21">21</A><span class="reserved_word">import</span> java.util.TimerTask;<BR/><A class="lineNum" name="line_22">22</A><BR/><A class="lineNum" name="line_23">23</A><span class="comment">/**<BR/><A class="lineNum" name="line_24">24</A> * &lt;p&gt;<BR/><A class="lineNum" name="line_25">25</A> * Provides a shared idle object eviction timer for all pools. This class wraps<BR/><A class="lineNum" name="line_26">26</A> * the standard {@link Timer} and keeps track of how many pools are using it.<BR/><A class="lineNum" name="line_27">27</A> * If no pools are using the timer, it is canceled. This prevents a thread<BR/><A class="lineNum" name="line_28">28</A> * being left running which, in application server environments, can lead to<BR/><A class="lineNum" name="line_29">29</A> * memory leads and/or prevent applications from shutting down or reloading<BR/><A class="lineNum" name="line_30">30</A> * cleanly.<BR/><A class="lineNum" name="line_31">31</A> * &lt;/p&gt;<BR/><A class="lineNum" name="line_32">32</A> * &lt;p&gt;<BR/><A class="lineNum" name="line_33">33</A> * This class has package scope to prevent its inclusion in the pool public API.<BR/><A class="lineNum" name="line_34">34</A> * The class declaration below should *not* be changed to public.<BR/><A class="lineNum" name="line_35">35</A> * &lt;/p&gt;<BR/><A class="lineNum" name="line_36">36</A> */</span><BR/><A class="lineNum" name="line_37">37</A><span class="reserved_word">class</span> EvictionTimer {<BR/><A class="lineNum" name="line_38">38</A>    <span class="reserved_word">private</span> <span class="reserved_word">static</span> Timer _timer;<BR/><A class="lineNum" name="line_39">39</A>    <span class="reserved_word">private</span> <span class="reserved_word">static</span> <span class="reserved_word">int</span> _usageCount;<BR/><A class="lineNum" name="line_40">40</A><BR/><A class="lineNum" name="line_41">41</A>    <span class="reserved_word">private</span> EvictionTimer() {<BR/><A class="lineNum" name="line_42">42</A>        <span class="comment">// Hide the default constuctor<BR/><A class="lineNum" name="line_43">43</A></span>    }<BR/><A class="lineNum" name="line_44">44</A><BR/><A class="lineNum" name="line_45">45</A>    <span class="comment">/**<BR/><A class="lineNum" name="line_46">46</A>     * Add the specified eviction task to the timer. Tasks that are added with a<BR/><A class="lineNum" name="line_47">47</A>     * call to this method *must* call {@link #cancel(TimerTask)} to cancel the<BR/><A class="lineNum" name="line_48">48</A>     * task to prevent memory and/or thread leaks in application server<BR/><A class="lineNum" name="line_49">49</A>     * environments.<BR/><A class="lineNum" name="line_50">50</A>     * @param task      Task to be scheduled<BR/><A class="lineNum" name="line_51">51</A>     * @param delay     Delay in milliseconds before task is executed<BR/><A class="lineNum" name="line_52">52</A>     * @param period    Time in milliseconds between executions<BR/><A class="lineNum" name="line_53">53</A>     */</span><BR/><A class="lineNum" name="line_54">54</A>    <span class="reserved_word">static</span> <span class="reserved_word">synchronized</span> <span class="reserved_word">void</span> schedule(TimerTask task, <span class="reserved_word">long</span> delay, <span class="reserved_word">long</span> period) {<BR/><A class="lineNum" name="line_55">55</A>        <span class="reserved_word">if</span> (<span class="reserved_word">null</span> == _timer) {<BR/><A class="lineNum" name="line_56">56</A>            _timer = <span class="reserved_word">new</span> Timer(<span class="reserved_word">true</span>);<BR/><A class="lineNum" name="line_57">57</A>        }<BR/><A class="lineNum" name="line_58">58</A>        _usageCount++;<BR/><A class="lineNum" name="line_59">59</A>        _timer.schedule(task, delay, period);<BR/><A class="lineNum" name="line_60">60</A>    }<BR/><A class="lineNum" name="line_61">61</A><BR/><A class="lineNum" name="line_62">62</A>    <span class="comment">/**<BR/><A class="lineNum" name="line_63">63</A>     * Remove the specified eviction task from the timer.<BR/><A class="lineNum" name="line_64">64</A>     * @param task      Task to be scheduled<BR/><A class="lineNum" name="line_65">65</A>     */</span><BR/><A class="lineNum" name="line_66">66</A>    <span class="reserved_word">static</span> <span class="reserved_word">synchronized</span> <span class="reserved_word">void</span> cancel(TimerTask task) {<BR/><A class="lineNum" name="line_67">67</A>        task.cancel();<BR/><A class="lineNum" name="line_68">68</A>        _usageCount--;<BR/><A class="lineNum" name="line_69">69</A>        <span class="reserved_word">if</span> (_usageCount == <span class="literal">0</span>) {<BR/><A class="lineNum" name="line_70">70</A>            _timer.cancel();<BR/><A class="lineNum" name="line_71">71</A>            _timer = <span class="reserved_word">null</span>;<BR/><A class="lineNum" name="line_72">72</A>        }<BR/><A class="lineNum" name="line_73">73</A>    }<BR/><A class="lineNum" name="line_74">74</A>}<BR/><A class="lineNum" name="line_75">75</A><BR/><A class="lineNum" name="line_76">76</A>
</PRE>
<HR>
<i>Hammurapi 3.18.4 Copyright &copy; 2004 Hammurapi Group. All Rights Reserved.</i>
</BODY>
</HTML>
